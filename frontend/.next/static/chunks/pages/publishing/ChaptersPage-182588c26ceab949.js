(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[258,781],{2258:(e,t,l)=>{"use strict";l.r(t),l.d(t,{aiApi:()=>r,apiClient:()=>i,musicApi:()=>n,tasksApi:()=>s,uploadFileToS3:()=>a});let i=l(1040).A.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});async function a(e){let{data:t}=await i.get("/s3-presigned-url",{params:{fileName:e.name,fileType:e.type}});return await fetch(t.presignedUrl,{method:"PUT",headers:{"Content-Type":e.type},body:e}),{fileUrl:t.fileUrl}}let n={getAll:()=>i.get("/music/releases"),create:e=>i.post("/music/releases",e),update:(e,t)=>i.patch("/music/releases/".concat(e),t),delete:e=>i.delete("/music/releases/".concat(e)),updateSplits:(e,t)=>i.patch("/music/releases/".concat(e,"/splits"),{splits:t})},s={getAll:()=>i.get("/music/tasks"),create:e=>i.post("/music/tasks",e),update:(e,t)=>i.patch("/music/tasks/".concat(e),t),delete:e=>i.delete("/music/tasks/".concat(e))},r={generateImage:e=>i.post("/ai/generate-images",{prompt:e}),generateContent:e=>i.post("/ai/generate-content",{prompt:e})}},4156:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/publishing/ChaptersPage",function(){return l(4575)}])},4575:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>o});var i=l(7876),a=l(4232),n=l(2604),s=l(2258);let r=e=>{let{chapter:t,onSave:l,onCancel:n}=e,[r,o]=(0,a.useState)(t.title),[d,c]=(0,a.useState)(t.content),[u,p]=(0,a.useState)(null),[h,g]=(0,a.useState)(null),[y,m]=(0,a.useState)(null),[x,j]=(0,a.useState)(t.imageUrl||""),[b,k]=(0,a.useState)(t.audioUrl||""),[f,w]=(0,a.useState)(t.fileUrl||""),[C,v]=(0,a.useState)(!1),[z,S]=(0,a.useState)({}),T=async(e,t)=>{v(!0);try{let{fileUrl:l}=await (0,s.uploadFileToS3)(e);t(l)}catch(e){alert("Błąd uploadu pliku.")}v(!1)};return(0,i.jsxs)("div",{style:{background:"#222",padding:24,borderRadius:8,maxWidth:600,margin:"0 auto"},children:[(0,i.jsx)("h3",{style:{color:"white"},children:"Edycja rozdziału"}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[(0,i.jsxs)("label",{style:{color:"white"},children:["Tytuł:",(0,i.jsx)("input",{type:"text",value:r,onChange:e=>o(e.target.value),style:{width:"100%"}})]}),z.title&&(0,i.jsx)("div",{style:{color:"red",fontSize:13},children:z.title})]}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[(0,i.jsxs)("label",{style:{color:"white"},children:["Treść:",(0,i.jsx)("textarea",{value:d,onChange:e=>c(e.target.value),style:{width:"100%"}})]}),z.content&&(0,i.jsx)("div",{style:{color:"red",fontSize:13},children:z.content})]}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[(0,i.jsxs)("label",{style:{color:"white"},children:["Obraz:",(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return p((null==(t=e.target.files)?void 0:t[0])||null)}})]}),u&&(0,i.jsx)("button",{type:"button",onClick:()=>T(u,j),disabled:C,children:"Wyślij obraz"}),x&&(0,i.jsx)("img",{src:x,alt:"obraz",style:{height:40,marginLeft:8,verticalAlign:"middle"}})]}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[(0,i.jsxs)("label",{style:{color:"white"},children:["Audio:",(0,i.jsx)("input",{type:"file",accept:"audio/*",onChange:e=>{var t;return g((null==(t=e.target.files)?void 0:t[0])||null)}})]}),h&&(0,i.jsx)("button",{type:"button",onClick:()=>T(h,k),disabled:C,children:"Wyślij audio"}),b&&(0,i.jsxs)("span",{style:{color:"white",marginLeft:8},children:["Plik audio załadowany",(0,i.jsx)("audio",{controls:!0,src:b,style:{display:"block",marginTop:8,maxWidth:300},children:"Tw\xf3j przeglądarka nie obsługuje odtwarzacza audio."})]})]}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[(0,i.jsxs)("label",{style:{color:"white"},children:["Dowolny plik:",(0,i.jsx)("input",{type:"file",onChange:e=>{var t;return m((null==(t=e.target.files)?void 0:t[0])||null)}})]}),y&&(0,i.jsx)("button",{type:"button",onClick:()=>T(y,w),disabled:C,children:"Wyślij plik"}),f&&(0,i.jsxs)("span",{style:{color:"white",marginLeft:8},children:["Plik załadowany",(0,i.jsx)("div",{style:{marginTop:8},children:f.endsWith(".pdf")?(0,i.jsx)("iframe",{src:f,style:{width:300,height:200,border:"1px solid #444",background:"#fff"},title:"Podgląd pliku PDF"}):(0,i.jsx)("a",{href:f,target:"_blank",rel:"noopener noreferrer",style:{color:"#90caf9"},children:"Pobierz / Otw\xf3rz plik"})})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[(0,i.jsx)("button",{type:"button",onClick:n,style:{background:"#666",color:"white",padding:"10px 20px",border:"none",borderRadius:4},children:"Anuluj"}),(0,i.jsx)("button",{type:"button",onClick:()=>{let e={};if(r.trim()||(e.title="Tytuł jest wymagany."),d.trim()||(e.content="Treść jest wymagana."),Object.keys(e).length>0)return void S(e);S({}),l({title:r,content:d,imageUrl:x,audioUrl:b,fileUrl:f})},disabled:C,style:{background:C?"#888":"#4CAF50",color:"white",padding:"10px 20px",border:"none",borderRadius:4},children:"Zapisz"})]})]})},o=e=>{let{bookId:t,onBack:l}=e,s=(0,n.C)(e=>e.publishing.books.find(e=>e.id===t)),o=(0,n.C)(e=>e.updateChapterContent),d=(0,n.C)(e=>e.addChapter),c=(0,n.C)(e=>e.replaceBookChapters),[u,p]=(0,a.useState)(null);return s?(0,i.jsxs)("div",{style:{padding:32},children:[(0,i.jsxs)("h2",{style:{color:"white"},children:["Rozdziały książki: ",s.title]}),(0,i.jsx)("button",{onClick:l,style:{marginBottom:24,background:"#666",color:"white",padding:"10px 20px",border:"none",borderRadius:4},children:"Powr\xf3t"}),(0,i.jsx)("ul",{style:{color:"white",marginBottom:24},children:s.chapters.map((e,l)=>(0,i.jsxs)("li",{style:{marginBottom:16},children:[(0,i.jsx)("strong",{children:e.title||"Rozdział ".concat(l+1)}),(0,i.jsx)("button",{style:{marginLeft:16},onClick:()=>p(l),children:"Edytuj"}),(0,i.jsx)("button",{style:{marginLeft:8,color:"red"},onClick:()=>{c(t,s.chapters.filter((e,t)=>t!==l))},children:"Usuń"}),e.imageUrl&&(0,i.jsx)("img",{src:e.imageUrl,alt:"obraz",style:{height:32,marginLeft:8,verticalAlign:"middle"}}),e.audioUrl&&(0,i.jsx)("span",{style:{marginLeft:8},children:"[audio]"}),e.fileUrl&&(0,i.jsx)("span",{style:{marginLeft:8},children:"[plik]"})]},l))}),(0,i.jsx)("button",{onClick:()=>d(t),style:{background:"#2196F3",color:"white",padding:"8px 16px",border:"none",borderRadius:4,marginBottom:24},children:"Dodaj rozdział"}),null!==u&&(0,i.jsx)(r,{chapter:s.chapters[u],onSave:async e=>{await o(t,u,e.content);let l=s.chapters.map((t,l)=>l===u?{...e}:t);n.C.getState().replaceBookChapters(t,l),p(null)},onCancel:()=>p(null)})]}):(0,i.jsx)("div",{style:{color:"white"},children:"Nie znaleziono książki."})}}},e=>{e.O(0,[40,604,636,593,792],()=>e(e.s=4156)),_N_E=e.O()}]);