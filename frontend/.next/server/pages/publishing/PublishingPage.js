"use strict";(()=>{var a={};a.id=880,a.ids=[220,880],a.modules={342:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>k});var e=c(8732),f=c(2015),g=c(6857),h=c(2589),i=c(5985),j=a([g,h,i]);[g,h,i]=j.then?(await j)():j;let k=()=>{let[a,b]=(0,f.useState)(!1),[c,d]=(0,f.useState)(null),j=(0,h.C)(a=>a.publishing.books);return null!==c?(0,e.jsx)(g.default,{bookId:c,onBack:()=>d(null)}):(0,e.jsxs)("div",{style:{padding:32},children:[(0,e.jsx)("h1",{style:{color:"white"},children:"Publikacje"}),(0,e.jsx)("button",{style:{marginBottom:24,background:"#4CAF50",color:"white",padding:"10px 20px",border:"none",borderRadius:4},onClick:()=>b(!0),children:"Dodaj książkę"}),a&&(0,e.jsx)(i.A,{onClose:()=>b(!1)}),(0,e.jsxs)("div",{style:{marginTop:32},children:[(0,e.jsx)("h2",{style:{color:"white"},children:"Lista książek"}),(0,e.jsx)("ul",{children:j.map(a=>(0,e.jsxs)("li",{style:{color:"white",marginBottom:12},children:[(0,e.jsx)("strong",{children:a.title})," — ",a.author," (",a.genre,")",a.coverImageUrl&&(0,e.jsx)("img",{src:a.coverImageUrl,alt:"okładka",style:{height:60,marginLeft:16,verticalAlign:"middle",borderRadius:4}}),(0,e.jsx)("button",{style:{marginLeft:16},onClick:()=>d(a.id),children:"Edytuj rozdziały"})]},a.id))})]})]})};d()}catch(a){d(a)}})},361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},1428:a=>{a.exports=import("axios")},2015:a=>{a.exports=require("react")},2177:a=>{a.exports=import("zustand")},2409:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(3885),f=c(237),g=c(1413),h=c(3317),i=c.n(h),j=c(4460),k=c(342),l=c(2289),m=a([k]);k=(m.then?(await m)():m)[0];let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/publishing/PublishingPage",pathname:"/publishing/PublishingPage",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/publishing/PublishingPage",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},3873:a=>{a.exports=require("path")},4822:a=>{a.exports=require("react-router-dom")},5985:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>j});var e=c(8732),f=c(2015),g=c(2589),h=c(2461),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=({onClose:a})=>{let b=(0,g.C)(a=>a.addBook),[c,d]=(0,f.useState)({title:"",author:"",genre:"",blurb:"",keywords:"",coverImageUrl:"",splits:[{name:"",share:""}],chapters:[{title:"",content:""}],rights:{territorial:!1,translation:!1,adaptation:!1,drm:!1}}),[i,j]=(0,f.useState)(null),[k,l]=(0,f.useState)([]),[m,n]=(0,f.useState)([]),[o,p]=(0,f.useState)(!1),[q,r]=(0,f.useState)(""),[s,t]=(0,f.useState)({}),u=async d=>{d.preventDefault();let e={};if(c.title.trim()||(e.title="Tytuł jest wymagany."),c.author.trim()||(e.author="Autor jest wymagany."),c.genre.trim()||(e.genre="Gatunek jest wymagany."),i||c.coverImageUrl||(e.cover="Okładka jest wymagana."),Object.keys(e).length>0)return void t(e);t({}),p(!0);let f=c.coverImageUrl;try{if(i){let{fileUrl:a}=await (0,h.uploadFileToS3)(i);f=a}let d=[];for(let a=0;a<k.length;a++){let b=k[a],{fileUrl:c}=await (0,h.uploadFileToS3)(b);d.push({url:c,prompt:q||""})}await b({...c,coverImageUrl:f,status:"Draft",illustrations:[...m,...d]}),p(!1),a()}catch(a){alert("Błąd uploadu pliku."),p(!1)}};return(0,e.jsxs)("div",{style:{background:"#222",padding:24,borderRadius:8,maxWidth:600,margin:"0 auto"},children:[(0,e.jsx)("h2",{style:{color:"white"},children:"Dodaj książkę"}),(0,e.jsxs)("form",{onSubmit:u,children:[(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsxs)("label",{style:{color:"white"},children:["Tytuł:",(0,e.jsx)("input",{type:"text",value:c.title,onChange:a=>d(b=>({...b,title:a.target.value})),style:{width:"100%"}})]}),s.title&&(0,e.jsx)("div",{style:{color:"red",fontSize:13},children:s.title})]}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsxs)("label",{style:{color:"white"},children:["Autor:",(0,e.jsx)("input",{type:"text",value:c.author,onChange:a=>d(b=>({...b,author:a.target.value})),style:{width:"100%"}})]}),s.author&&(0,e.jsx)("div",{style:{color:"red",fontSize:13},children:s.author})]}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsxs)("label",{style:{color:"white"},children:["Gatunek:",(0,e.jsx)("input",{type:"text",value:c.genre,onChange:a=>d(b=>({...b,genre:a.target.value})),style:{width:"100%"}})]}),s.genre&&(0,e.jsx)("div",{style:{color:"red",fontSize:13},children:s.genre})]}),(0,e.jsx)("div",{style:{marginBottom:12},children:(0,e.jsxs)("label",{style:{color:"white"},children:["Blurb:",(0,e.jsx)("textarea",{value:c.blurb,onChange:a=>d(b=>({...b,blurb:a.target.value})),style:{width:"100%"}})]})}),(0,e.jsx)("div",{style:{marginBottom:12},children:(0,e.jsxs)("label",{style:{color:"white"},children:["Słowa kluczowe:",(0,e.jsx)("input",{type:"text",value:c.keywords,onChange:a=>d(b=>({...b,keywords:a.target.value})),style:{width:"100%"}})]})}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsxs)("label",{style:{color:"white"},children:["Okładka:",(0,e.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{a.target.files&&a.target.files[0]&&j(a.target.files[0])}})]}),i&&(0,e.jsxs)("span",{style:{color:"white"},children:["Wybrano: ",i.name]}),s.cover&&(0,e.jsx)("div",{style:{color:"red",fontSize:13},children:s.cover})]}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsxs)("label",{style:{color:"white"},children:["Ilustracje:",(0,e.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:a=>{a.target.files&&l(Array.from(a.target.files))}})]}),(0,e.jsx)("input",{type:"text",placeholder:"Prompt (opis ilustracji) - opcjonalnie dla wszystkich",value:q,onChange:a=>r(a.target.value),style:{width:"100%",marginTop:8}}),k.length>0&&(0,e.jsx)("ul",{style:{color:"white",marginTop:8},children:k.map((a,b)=>(0,e.jsxs)("li",{style:{display:"flex",alignItems:"center",gap:8},children:[a.name,(0,e.jsx)("button",{type:"button",style:{marginLeft:8},onClick:()=>l(a=>a.filter((a,c)=>c!==b)),children:"Usuń"})]},b))}),m.length>0&&(0,e.jsx)("ul",{style:{color:"white",marginTop:8},children:m.map((a,b)=>(0,e.jsxs)("li",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,e.jsx)("img",{src:a.url,alt:"ilustracja",style:{height:40,marginRight:8,verticalAlign:"middle"}}),a.prompt&&(0,e.jsx)("span",{style:{fontStyle:"italic",marginLeft:8},children:a.prompt}),(0,e.jsx)("button",{type:"button",style:{marginLeft:8},onClick:()=>n(a=>a.filter((a,c)=>c!==b)),children:"Usuń"})]},b))})]}),(0,e.jsxs)("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[(0,e.jsx)("button",{type:"button",onClick:a,style:{background:"#666",color:"white",padding:"10px 20px",border:"none",borderRadius:4},children:"Anuluj"}),(0,e.jsx)("button",{type:"submit",disabled:o,style:{background:o?"#888":"#4CAF50",color:"white",padding:"10px 20px",border:"none",borderRadius:4},children:o?"Wysyłanie...":"Dodaj książkę"})]})]})]})};d()}catch(a){d(a)}})},6060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},7085:a=>{a.exports=require("styled-jsx/style")},8732:a=>{a.exports=require("react/jsx-runtime")}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[317,162,12],()=>b(b.s=2409));module.exports=c})();